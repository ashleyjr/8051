#!/bin/bash
CMD="cd verif/src"
echo $CMD
$CMD

CMD="make"
echo $CMD
$CMD

CMD="cd ../.."
echo $CMD
$CMD

ext=".hex"
CMD="cp -f ${1/\.c/$ext} load_mem.hex"
echo $CMD
$CMD

ext=".checks"
CMD="cp -f ${1/\.c/$ext} checks.hex"
echo $CMD
$CMD

CMD="iverilog -o ice51.dat -D SIM -c etc/filelist.txt"
echo $CMD
$CMD

CMD="vvp ice51.dat -vcd > /dev/null 2>&1"
echo $CMD
$CMD 

WAVES="w"
if [[ "$2" == "$WAVES" ]]; then
   CMD="gtkwave -S etc/signals.tcl ice51.vcd"
   echo $CMD
   $CMD
fi
